# 参拝客システム (Worshipper System)

## 概要
ランダムなタイミングで参拝客が訪れて、賽銭を入れて去っていくシステムを実装しました。

## ファイル
- `miko_game_with_worshippers.go` - 参拝客システム付きのメインゲーム

## 実行方法
```bash
go run miko_game_with_worshippers.go
```

## 機能

### 参拝客の行動
1. **出現**: 画面左右からランダムに参拝客が出現（5秒間隔、30%確率）
2. **移動**: 賽銭箱（座標[4][8]）に向かって自動移動
3. **参拝**: 賽銭箱で2秒間参拝（軽いバウンス効果）
4. **退場**: 画面外に向かって移動（フェードアウト効果）

### 視覚的効果
- **色のバリエーション**: 5種類の色で参拝客を区別
- **参拝アニメーション**: 賽銭箱での軽いバウンス効果
- **退場エフェクト**: 徐々にフェードアウト

### UI表示
- 現在の参拝客数
- 現在の賽銭数（参拝中の人数）
- 総賽銭数（累計参拝者数）

## 操作方法
- **WASD/矢印キー**: プレイヤー移動
- **E**: 編集モード切替
- **Space**: カメラリセット（編集モード時）

### 編集モード
- **Q/R**: タイルX選択
- **T/Y**: タイルY選択
- **左クリック**: タイル配置

## 技術的詳細

### 参拝客の状態管理
```go
type WorshipperState int

const (
    StateApproaching  // 賽銭箱に向かう
    StateOffering     // 参拝中
    StateLeaving      // 退場中
)
```

### ランダム要素
- 出現タイミング（5秒間隔 + 30%確率）
- 出現位置（左右ランダム）
- 移動速度（基本速度 + ランダム変動）
- 色（5種類からランダム選択）

## カスタマイズ可能な定数
```go
const (
    spawnInterval     = 300 // 出現間隔（フレーム）
    offeringDuration  = 120 // 参拝時間（フレーム）
    worshipperSpeed   = 1.0 // 参拝客の移動速度
)
```